<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Weekly Picks Results</title>
<style>
  :root{
    --bg:#f7f9fc;
    --panel:#ffffff;
    --line:#d0d7e3;
    --fg:#1a1a1a;
    --muted:#555;
    --hover:#e9f2ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  header{padding:20px;border-bottom:1px solid var(--line);background:#f0f4fa;position:sticky;top:0;z-index:10}
  h1{margin:0;font-size:22px}
  .sub{color:var(--muted);font-size:14px;margin-top:6px}
  main{max-width:1100px;margin:18px auto;padding:0 16px}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:10px;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,0.08)}
  .status{font-size:13px;color:var(--muted);margin:8px 0 12px}
  .grid{overflow:auto;border-radius:8px;border:1px solid var(--line)}
  table{width:100%;border-collapse:collapse;font-size:14px}
  thead th{position:sticky;top:0;background:#f0f4fa;border-bottom:2px solid var(--line);text-align:left;padding:10px;font-weight:700;color:#000}
  tbody td{padding:10px;border-bottom:1px solid var(--line)}
  tbody tr:nth-child(odd){background:#fafbfc}
  tbody tr:nth-child(even){background:#f5f7fa}
  tbody tr:hover{background:var(--hover)}
  tfoot td{padding:10px;border-top:2px solid var(--line);background:#f0f4fa;color:#333;font-weight:700}
  .right{text-align:right}
</style>
</head>
<body>
  <header>
    <h1>Weekly Picks Results</h1>
    <div class="sub">This page always shows the latest results from <code>/data/latest.csv</code>.</div>
  </header>

  <main>
    <section class="card">
      <div class="status" id="status">Loading…</div>
      <div class="grid" id="grid" aria-live="polite"></div>
    </section>
  </main>

<script>
// --- Config: expects CSV at /data/latest.csv
const CSV_URL = './data/latest.csv';

function parseCSV(text){
  const lines = text.split(/\r?\n/).filter(l => l.trim() !== '');
  return lines.map(l => l.split(',').map(s => s.trim()));
}

function renderTable(arr){
  const grid = document.getElementById('grid');
  if(!arr || !arr.length){ grid.innerHTML = '<div style="padding:12px;color:#555">No data</div>'; return; }

  const [headers, ...rows] = arr;
  const tbl = document.createElement('table');

  const thead = document.createElement('thead');
  const trh = document.createElement('tr');
  trh.appendChild(document.createElement('th')).textContent = 'Game';
  headers.forEach(h => { const th = document.createElement('th'); th.textContent = h; trh.appendChild(th); });
  thead.appendChild(trh);
  tbl.appendChild(thead);

  const tbody = document.createElement('tbody');
  rows.forEach((r, i) => {
    const tr = document.createElement('tr');
    const label = document.createElement('td');
    label.textContent = `Game ${i+1}`;
    label.style.fontWeight = '600';
    tr.appendChild(label);
    headers.forEach((_, idx) => {
      const td = document.createElement('td');
      td.textContent = r[idx] ?? '';
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  tbl.appendChild(tbody);

  grid.innerHTML = '';
  grid.appendChild(tbl);
}

async function loadCSV(){
  const s = document.getElementById('status');
  try{
    s.textContent = 'Fetching latest.csv…';
    const r = await fetch(CSV_URL, { cache: 'no-store' });
    if(!r.ok) throw new Error(`HTTP ${r.status}`);
    const text = await r.text();
    const arr = parseCSV(text);
    renderTable(arr);
    s.textContent = 'Loaded.';
  }catch(err){
    console.error(err);
    s.textContent = 'Failed to load data. Ensure /data/latest.csv exists.';
  }
}

loadCSV();
</script>
</body>
</html>
